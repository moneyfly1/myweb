# è®¢é˜…åœ°å€æµ‹è¯•è¯´æ˜

## ä¿®å¤å†…å®¹

å·²ä¿®å¤è®¢é˜…åœ°å€è·å–èŠ‚ç‚¹å¤±è´¥çš„é—®é¢˜ï¼š

1. **ä¿®å¤ `getSiteURL()` å‡½æ•°**ï¼š
   - å°†æŸ¥è¯¢ `domain_name` çš„ category ä» `system` æ”¹ä¸º `general`
   - ç¡®ä¿ä¸ç³»ç»Ÿè®¾ç½®ä¸­çš„é…ç½®ä¸€è‡´

2. **ä¿®å¤ `getNodesForSubscription()` å‡½æ•°**ï¼š
   - åœ¨æŸ¥è¯¢ `node_source_urls` æ—¶æ·»åŠ  `category = "config_update"` æ¡ä»¶
   - ç¡®ä¿ä»æ­£ç¡®çš„é…ç½®åˆ†ç±»è·å–èŠ‚ç‚¹æº

3. **ä¿®å¤ `GenerateClashConfig()` å‡½æ•°**ï¼š
   - åŒæ ·æ·»åŠ  `category = "config_update"` æ¡ä»¶æ¥æŸ¥è¯¢ `node_source_urls`

## æµ‹è¯•æ–¹æ³•

### æ–¹æ³•1ï¼šä½¿ç”¨æµ‹è¯•è„šæœ¬

```bash
# åœ¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ
cd /www/wwwroot/dy.moneyfly.top
./test_subscription.sh dy.moneyfly.top <è®¢é˜…URL>
```

### æ–¹æ³•2ï¼šä½¿ç”¨ curl å‘½ä»¤

```bash
# æ›¿æ¢ {subscription_url} ä¸ºå®é™…çš„è®¢é˜…URL
# æ›¿æ¢ {timestamp} ä¸ºå½“å‰æ—¶é—´æˆ³

# æµ‹è¯• Clash è®¢é˜…
curl -H "User-Agent: ClashForWindows/1.0.0" \
  "https://dy.moneyfly.top/api/v1/subscriptions/clash/{subscription_url}?t={timestamp}"

# æµ‹è¯• V2Ray è®¢é˜…
curl -H "User-Agent: V2RayNG/1.0.0" \
  "https://dy.moneyfly.top/api/v1/subscriptions/v2ray/{subscription_url}?t={timestamp}"

# æµ‹è¯• SSR è®¢é˜…
curl -H "User-Agent: ShadowsocksR/1.0.0" \
  "https://dy.moneyfly.top/api/v1/subscriptions/ssr/{subscription_url}?t={timestamp}"
```

### æ–¹æ³•3ï¼šåœ¨æµè§ˆå™¨ä¸­æµ‹è¯•

1. ç™»å½•ç”¨æˆ·ç«¯
2. è¿›å…¥"æˆ‘çš„è®¢é˜…"é¡µé¢
3. å¤åˆ¶è®¢é˜…åœ°å€
4. åœ¨æµè§ˆå™¨ä¸­è®¿é—®è®¢é˜…åœ°å€ï¼ˆClashæ ¼å¼ï¼‰

## é¢„æœŸç»“æœ

å¦‚æœä¿®å¤æˆåŠŸï¼Œè®¢é˜…åœ°å€åº”è¯¥èƒ½å¤Ÿï¼š

1. âœ… æ­£å¸¸è¿”å›èŠ‚ç‚¹é…ç½®ï¼ˆClash YAML æ ¼å¼ï¼‰
2. âœ… åŒ…å«ä¿¡æ¯èŠ‚ç‚¹ï¼š
   - ğŸ“¢ ç½‘ç«™åŸŸå
   - â° åˆ°æœŸæ—¶é—´
   - ğŸ’¬ å”®åQQ: 3219904322
3. âœ… åŒ…å«æ‰€æœ‰å¯ç”¨çš„èŠ‚ç‚¹ï¼ˆä»æ•°æ®åº“æˆ–èŠ‚ç‚¹æºURLè·å–ï¼‰

## æ•…éšœæ’æŸ¥

å¦‚æœä»ç„¶æ— æ³•è·å–èŠ‚ç‚¹ï¼Œè¯·æ£€æŸ¥ï¼š

1. **æ•°æ®åº“ä¸­çš„èŠ‚ç‚¹**ï¼š
   ```sql
   SELECT COUNT(*) FROM nodes WHERE is_active = 1;
   ```

2. **èŠ‚ç‚¹æºé…ç½®**ï¼š
   ```sql
   SELECT * FROM system_configs 
   WHERE key = 'node_source_urls' AND category = 'config_update';
   ```

3. **åŸŸåé…ç½®**ï¼š
   ```sql
   SELECT * FROM system_configs 
   WHERE key = 'domain_name' AND category = 'general';
   ```

4. **æœåŠ¡å™¨æ—¥å¿—**ï¼š
   ```bash
   tail -f /www/wwwroot/dy.moneyfly.top/server.log
   ```

## æ³¨æ„äº‹é¡¹

- ç¡®ä¿æœåŠ¡å™¨å·²é‡å¯ä»¥åŠ è½½æœ€æ–°ä»£ç 
- ç¡®ä¿æ•°æ®åº“ä¸­æœ‰èŠ‚ç‚¹æˆ–é…ç½®äº†èŠ‚ç‚¹æºURL
- ç¡®ä¿è®¢é˜…çŠ¶æ€ä¸ºæœ‰æ•ˆï¼ˆæœªè¿‡æœŸã€å·²æ¿€æ´»ã€è®¾å¤‡æœªè¶…é™ï¼‰

